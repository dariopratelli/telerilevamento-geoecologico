library(terra)
library(ggplot2) 
library(viridis)

#1986 data
setwd("C:/Users/utente/Desktop/Adamello/1986")
b2_1986<-rast("b2_1986.tif")
plot(b2_1986)
b5_1986<-rast("b5_1986.tif")
plot(b5_1986)
NDSI_1986<-(b2_1986-b5_1986)/(b2_1986+b5_1986)
plot(NDSI_1986)
NDSI_1986c<-NDSI_1986>0.4
plot(NDSI_1986c)

fre1986<-freq(NDSI_1986c)
fre1986
  
tot1986<-ncell(NDSI_1986c)
tot1986

prop1986=fre1986/tot1986
prop1986

perc1986=prop1986*100
perc1986

par(mfrow=c(2,2))
plot(b2_1986)
plot(b5_1986)
plot(NDSI_1986)
plot(NDSI_1986c)
dev.off()

#1997 data
setwd("C:/Users/utente/Desktop/Adamello/1997")
b2_1997<-rast("b2_1997.tif")
plot(b2_1997)
b5_1997<-rast("b5_1997.tif")
plot(b5_1997)
NDSI_1997<-(b2_1997-b5_1997)/(b2_1997+b5_1997)
plot(NDSI_1997)
NDSI_1997c<-NDSI_1997>0.4
plot(NDSI_1997c)

fre1997<-freq(NDSI_1997c)
fre1997
  
tot1997<-ncell(NDSI_1997c)
tot1997

prop1997=fre1997/tot1997
prop1997
perc1997=prop1997*100
perc1997

par(mfrow=c(2,2))
plot(b2_1997)
plot(b5_1997)
plot(NDSI_1997)
plot(NDSI_1997c)
dev.off()

#2005 data
setwd("C:/Users/utente/Desktop/Adamello/2005")
b2_2005<-rast("b2_2005.tif")
plot(b2_2005)
b5_2005<-rast("b5_2005.tif")
plot(b5_2005)
NDSI_2005<-(b2_2005-b5_2005)/(b2_2005+b5_2005)
plot(NDSI_2005)
NDSI_2005c<-NDSI_2005>0.4
plot(NDSI_2005c)

fre2005<-freq(NDSI_2005c)
fre2005
  
tot2005<-ncell(NDSI_2005c)
tot2005

prop2005=fre2005/tot2005
prop2005

perc2005=prop2005*100
perc2005

par(mfrow=c(2,2))
plot(b2_2005)
plot(b5_2005)
plot(NDSI_2005)
plot(NDSI_2005c)
dev.off()

#2013 data
setwd("C:/Users/utente/Desktop/Adamello/2013")
b3_2013<-rast("b3_2013.tif")
plot(b3_2013)
b6_2013<-rast("b6_2013.tif")
plot(b6_2013)
NDSI_2013<-(b3_2013-b6_2013)/(b3_2013+b6_2013)
plot(NDSI_2013)
NDSI_2013c<-NDSI_2013>0.4
plot(NDSI_2013c)

fre2013<-freq(NDSI_2013c)
fre2013
  
tot2013<-ncell(NDSI_2013c)
tot2013

prop2013=fre2013/tot2013
prop2013

perc2013=prop2013*100
perc2013

par(mfrow=c(2,2))
plot(b3_2013)
plot(b6_2013)
plot(NDSI_2013)
plot(NDSI_2013c)
dev.off()

#2023 data
setwd("C:/Uses/utente/Desktop/Adamello/2023")
b3_2023<-rast("b3_2023.tif")
plot(b3_2023)
b6_2023<-rast("b6_2023.tif")
plot(b6_2023)
NDSI_2023<-(b3_2023-b6_2023)/(b3_2023+b6_2023)
plot(NDSI_2023)
NDSI_2023c<-NDSI_2023>0.4
plot(NDSI_2023c)

fre2023<-freq(NDSI_2023c)
fre2023

tot2023<-ncell(NDSI_2023c)
tot2023

prop2023=fre2023/tot2023
prop2023

perc2023=prop2023*100
perc2023

par(mfrow=c(2,2))
plot(b3_2023)
plot(b6_2023)
plot(NDSI_2023)
plot(NDSI_2023c)

dev.off()

par(mfrow=c(2,3))
plot(NDSI_1986c)
plot(NDSI_1997c)
plot(NDSI_2005c)
plot(NDSI_2013c)
plot(NDSI_2023c)

